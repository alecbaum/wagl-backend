{
  "ConnectionStrings": {
    "PostgreSQL": "Host=${DATABASE_HOST};Database=${DATABASE_NAME};Username=${DATABASE_USER};Password=${DATABASE_PASSWORD};Port=${DATABASE_PORT};SSL Mode=${DATABASE_SSL_MODE}",
    "Redis": "${REDIS_CONNECTION_STRING}"
  },
  "Authentication": {
    "Jwt": {
      "SecretKey": "${JWT_SECRET_KEY}",
      "Issuer": "${JWT_ISSUER}",
      "Audience": "${JWT_AUDIENCE}",
      "ExpirationMinutes": "${JWT_EXPIRATION_MINUTES}",
      "RefreshTokenExpirationDays": "${JWT_REFRESH_TOKEN_EXPIRATION_DAYS}",
      "ValidateIssuer": true,
      "ValidateAudience": true,
      "ValidateLifetime": true,
      "ValidateIssuerSigningKey": true,
      "ClockSkewSeconds": 300
    },
    "ApiKey": {
      "HeaderName": "Authorization",
      "Prefix": "Bearer"
    }
  },
  "RateLimiting": {
    "EnableRateLimiting": true,
    "EnableRedisRateLimiting": true,
    "Policies": {
      "Tier1": {
        "PermitLimit": 100,
        "Window": "01:00:00",
        "QueueLimit": 0,
        "AutoReplenishment": true
      },
      "Tier2": {
        "PermitLimit": 500,
        "Window": "01:00:00",
        "QueueLimit": 0,
        "AutoReplenishment": true
      },
      "Tier3": {
        "PermitLimit": 2000,
        "Window": "01:00:00",
        "QueueLimit": 0,
        "AutoReplenishment": true
      },
      "Provider": {
        "PermitLimit": 100000000,
        "Window": "01:00:00",
        "QueueLimit": 0,
        "AutoReplenishment": true
      }
    }
  },
  "Redis": {
    "ConnectionString": "localhost:6379",
    "InstanceName": "WaglBackendCache",
    "DefaultExpirationMinutes": 5,
    "AbortOnConnectFail": false,
    "ConnectRetryCount": 3,
    "Database": 0,
    "EnableKeyspaceNotifications": false,
    "KeyPrefix": "wagl:"
  },
  "Database": {
    "PostgreSQLConnectionString": "Host=localhost;Database=wagldb;Username=wagl_user;Password=****;Port=5432",
    "EnableSensitiveDataLogging": false,
    "EnableDetailedErrors": false,
    "CommandTimeout": 30,
    "MaxRetryCount": 3,
    "MaxRetryDelay": "00:00:30",
    "EnableServiceProviderCaching": true,
    "EnableQuerySplittingBehavior": false
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Microsoft.EntityFrameworkCore": "Warning"
    }
  },
  "Serilog": {
    "Using": ["Serilog.Sinks.Console", "Serilog.Sinks.File", "Serilog.Sinks.PostgreSQL"],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning",
        "Microsoft.EntityFrameworkCore": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "[{Timestamp:HH:mm:ss} {Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/wagl-backend-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 7,
          "outputTemplate": "[{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} {Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      },
      {
        "Name": "PostgreSQL",
        "Args": {
          "connectionString": "${ConnectionStrings:PostgreSQL}",
          "tableName": "Logs",
          "autoCreateSqlTable": true,
          "needAutoCreateTable": true,
          "restrictedToMinimumLevel": "Warning"
        }
      }
    ],
    "Enrich": ["FromLogContext", "WithMachineName", "WithProcessId", "WithThreadId", "WithEnvironmentName"],
    "Properties": {
      "Application": "WaglBackend"
    }
  },
  "AllowedHosts": "*",
  "Cors": {
    "AllowedOrigins": [
      "http://localhost:3000",
      "https://localhost:3001"
    ]
  },
  "Features": {
    "EnableSwagger": true,
    "EnableHealthChecks": true,
    "EnableMetrics": true,
    "EnableAuditLogging": true
  },
  "UAI": {
    "BaseUrl": "https://thinkscape-test-server.unanimous.ai/unity-api",
    "TestSessionId": "54.196.26.13",
    "AvailableRooms": [1, 2, 3],
    "HealthCheckRoom": 0,
    "DefaultUrlParams": "?source=web&version=1.0",
    "TimeoutMs": 5000,
    "EnableIntegration": true,
    "RetryPolicy": {
      "MaxAttempts": 3,
      "BaseDelayMs": 1000,
      "MaxDelayMs": 30000,
      "EnableExponentialBackoff": true,
      "EnableJitter": true,
      "BackoffMultiplier": 2.0,
      "CircuitBreakerFailureThreshold": 5,
      "CircuitBreakerSamplingDurationMs": 60000,
      "CircuitBreakerMinimumThroughput": 3,
      "CircuitBreakerDurationOfBreakMs": 30000
    },
    "Endpoints": {
      "Health": "/api/health",
      "MessageSend": "/api/message/send",
      "UserConnect": "/api/user/connect",
      "UserDisconnect": "/api/user/disconnect"
    }
  }
}